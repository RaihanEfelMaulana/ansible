---
# Red Hat Insights has recommended one or more actions for you, a system administrator, to review and if you
# deem appropriate, deploy on your systems running Red Hat software. Based on the analysis, we have automatically
# generated an Ansible Playbook for you. Please review and test the recommended actions and the Playbook as
# they may contain configuration changes, updates, reboots and/or other changes to your systems. Red Hat is not
# responsible for any adverse outcomes related to these recommendations or Playbooks.
#
# rhel9-parrot-playbook
# https://console.redhat.com/insights/remediations/986b57a2-1824-4163-a57d-af48b57305ec
# Generated by Red Hat Insights on Fri, 07 Nov 2025 03:18:03 GMT
# Created by raihanefel

# Upgrade the following packages:
#   - Upgrade packages affected by CVE-2020-11023
#   - Upgrade packages affected by CVE-2022-50087
#   - Upgrade packages affected by CVE-2022-50367
#   - Upgrade packages affected by CVE-2023-40546
#   - Upgrade packages affected by CVE-2023-40547
#   - Upgrade packages affected by CVE-2023-40548
#   - Upgrade packages affected by CVE-2023-40549
#   - Upgrade packages affected by CVE-2023-40550
#   - Upgrade packages affected by CVE-2023-40551
#   - Upgrade packages affected by CVE-2023-53125
#   - Upgrade packages affected by CVE-2023-53331
#   - Upgrade packages affected by CVE-2023-53373
#   - Upgrade packages affected by CVE-2023-53494
#   - Upgrade packages affected by CVE-2024-50301
#   - Upgrade packages affected by CVE-2025-11021
#   - Upgrade packages affected by CVE-2025-22026
#   - Upgrade packages affected by CVE-2025-22097
#   - Upgrade packages affected by CVE-2025-32988
#   - Upgrade packages affected by CVE-2025-32989
#   - Upgrade packages affected by CVE-2025-32990
#   - Upgrade packages affected by CVE-2025-37810
#   - Upgrade packages affected by CVE-2025-38332
#   - Upgrade packages affected by CVE-2025-38351
#   - Upgrade packages affected by CVE-2025-38352
#   - Upgrade packages affected by CVE-2025-38449
#   - Upgrade packages affected by CVE-2025-38472
#   - Upgrade packages affected by CVE-2025-38498
#   - Upgrade packages affected by CVE-2025-38527
#   - Upgrade packages affected by CVE-2025-38550
#   - Upgrade packages affected by CVE-2025-38556
#   - Upgrade packages affected by CVE-2025-38566
#   - Upgrade packages affected by CVE-2025-38571
#   - Upgrade packages affected by CVE-2025-38614
#   - Upgrade packages affected by CVE-2025-38718
#   - Upgrade packages affected by CVE-2025-39682
#   - Upgrade packages affected by CVE-2025-39694
#   - Upgrade packages affected by CVE-2025-39698
#   - Upgrade packages affected by CVE-2025-39702
#   - Upgrade packages affected by CVE-2025-39718
#   - Upgrade packages affected by CVE-2025-39730
#   - Upgrade packages affected by CVE-2025-39751
#   - Upgrade packages affected by CVE-2025-39757
#   - Upgrade packages affected by CVE-2025-39761
#   - Upgrade packages affected by CVE-2025-39817
#   - Upgrade packages affected by CVE-2025-39819
#   - Upgrade packages affected by CVE-2025-39841
#   - Upgrade packages affected by CVE-2025-39849
#   - Upgrade packages affected by CVE-2025-43272
#   - Upgrade packages affected by CVE-2025-43342
#   - Upgrade packages affected by CVE-2025-43343
#   - Upgrade packages affected by CVE-2025-43356
#   - Upgrade packages affected by CVE-2025-43368
#   - Upgrade packages affected by CVE-2025-48964
#   - Upgrade packages affected by CVE-2025-4945
#   - Upgrade packages affected by CVE-2025-5318
#   - Upgrade packages affected by CVE-2025-53905
#   - Upgrade packages affected by CVE-2025-53906
#   - Upgrade packages affected by CVE-2025-6395
# Identifier: (vulnerabilities:CVE-2020-11023,vulnerabilities:CVE-2022-50087,vulnerabilities:CVE-2022-50367,vulnerabilities:CVE-2023-40546,vulnerabilities:CVE-2023-40547,vulnerabilities:CVE-2023-40548,vulnerabilities:CVE-2023-40549,vulnerabilities:CVE-2023-40550,vulnerabilities:CVE-2023-40551,vulnerabilities:CVE-2023-53125,vulnerabilities:CVE-2023-53331,vulnerabilities:CVE-2023-53373,vulnerabilities:CVE-2023-53494,vulnerabilities:CVE-2024-50301,vulnerabilities:CVE-2025-11021,vulnerabilities:CVE-2025-22026,vulnerabilities:CVE-2025-22097,vulnerabilities:CVE-2025-32988,vulnerabilities:CVE-2025-32989,vulnerabilities:CVE-2025-32990,vulnerabilities:CVE-2025-37810,vulnerabilities:CVE-2025-38332,vulnerabilities:CVE-2025-38351,vulnerabilities:CVE-2025-38352,vulnerabilities:CVE-2025-38449,vulnerabilities:CVE-2025-38472,vulnerabilities:CVE-2025-38498,vulnerabilities:CVE-2025-38527,vulnerabilities:CVE-2025-38550,vulnerabilities:CVE-2025-38556,vulnerabilities:CVE-2025-38566,vulnerabilities:CVE-2025-38571,vulnerabilities:CVE-2025-38614,vulnerabilities:CVE-2025-38718,vulnerabilities:CVE-2025-39682,vulnerabilities:CVE-2025-39694,vulnerabilities:CVE-2025-39698,vulnerabilities:CVE-2025-39702,vulnerabilities:CVE-2025-39718,vulnerabilities:CVE-2025-39730,vulnerabilities:CVE-2025-39751,vulnerabilities:CVE-2025-39757,vulnerabilities:CVE-2025-39761,vulnerabilities:CVE-2025-39817,vulnerabilities:CVE-2025-39819,vulnerabilities:CVE-2025-39841,vulnerabilities:CVE-2025-39849,vulnerabilities:CVE-2025-43272,vulnerabilities:CVE-2025-43342,vulnerabilities:CVE-2025-43343,vulnerabilities:CVE-2025-43356,vulnerabilities:CVE-2025-43368,vulnerabilities:CVE-2025-48964,vulnerabilities:CVE-2025-4945,vulnerabilities:CVE-2025-5318,vulnerabilities:CVE-2025-53905,vulnerabilities:CVE-2025-53906,vulnerabilities:CVE-2025-6395,fix)
# Version: unknown
- name: update vulnerable packages
  hosts: 10.129.0.76
  vars:
    insights_issues: "--cve CVE-2020-11023 --cve CVE-2022-50087 --cve CVE-2022-50367 --cve CVE-2023-40546 --cve CVE-2023-40547 --cve CVE-2023-40548 --cve CVE-2023-40549 --cve CVE-2023-40550 --cve CVE-2023-40551 --cve CVE-2023-53125 --cve CVE-2023-53331 --cve CVE-2023-53373 --cve CVE-2023-53494 --cve CVE-2024-50301 --cve CVE-2025-11021 --cve CVE-2025-22026 --cve CVE-2025-22097 --cve CVE-2025-32988 --cve CVE-2025-32989 --cve CVE-2025-32990 --cve CVE-2025-37810 --cve CVE-2025-38332 --cve CVE-2025-38351 --cve CVE-2025-38352 --cve CVE-2025-38449 --cve CVE-2025-38472 --cve CVE-2025-38498 --cve CVE-2025-38527 --cve CVE-2025-38550 --cve CVE-2025-38556 --cve CVE-2025-38566 --cve CVE-2025-38571 --cve CVE-2025-38614 --cve CVE-2025-38718 --cve CVE-2025-39682 --cve CVE-2025-39694 --cve CVE-2025-39698 --cve CVE-2025-39702 --cve CVE-2025-39718 --cve CVE-2025-39730 --cve CVE-2025-39751 --cve CVE-2025-39757 --cve CVE-2025-39761 --cve CVE-2025-39817 --cve CVE-2025-39819 --cve CVE-2025-39841 --cve CVE-2025-39849 --cve CVE-2025-43272 --cve CVE-2025-43342 --cve CVE-2025-43343 --cve CVE-2025-43356 --cve CVE-2025-43368 --cve CVE-2025-48964 --cve CVE-2025-4945 --cve CVE-2025-5318 --cve CVE-2025-53905 --cve CVE-2025-53906 --cve CVE-2025-6395"
    insights_signature_exclude: /hosts,/vars/insights_signature,/vars/insights_issues
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldrWjZORlJqZG5jMU9FUXJhalZ3VGtGUmFUVm9aeTh2VTBKTmNY
      RnZRekYzVFRWU1JFUk9ibFYwUVRoRE9XZG5UVlV2UVhObVMwMEtZMXBKY0c1aVIyWnhhbEkzYzJw
      NFFYSXpkWGxZUWxReVQyOTBOVUp5V0dOQlQyTXdhblJJVDJ0UlJFTmhlR1ozYmxZeVVWSldiVUkw
      WWxOSllYbFNRZ3BKY1U5aE1tbEhSREZSTlN0bmVVUnNkM1poZEhkSmRFaEViME4wZGs1QmVFRkJi
      bmRrVUVkWlJEVnJSMWNyZEdFNVExQkJaa2RaVTNsQ1RIRm9PVFZuQ21zMFlrNTBkMHRVUzFOYVNV
      WTJVbWN5TUdKWFRFdzBUa1l4ZUVJeGJ6VlJWMmxqVDBwaGNtVlphazhyZW01TFZEVTJiMDQyUzFC
      TlRtSnNVV0ppYVRrS1NFTk1SMjVaYmtFMWJVdzNSbkJTYm1jMVIySlRVRVJyV2sxUWFURlBURzF4
      U3prdlpWWnFhMXBsWVhoWFpUWkdRamR0Vm5ST2FtTnFZM2xUUTNkcU9RcHFORVI1WVVSclNrOUJX
      a0pzYkhKc1lVczNUbEE0UmpkVk5rMHlWbVYyWTNGS1lsUXllbkUzZFZWcWVITjJNV2d4ZGpoSFN6
      UkpkbWhWY25sT2NsWk5Da3hHYUU1MlZtSm9UV3R5VGpoRVpVNVRSMUp1YWxadGFWQkRkbmw1UWtK
      NlEyOTBiVXBaZDFFMUsyTkxNbUZ1VVZKUFNWQnRVVFpHZURoamRrRkhSa2NLT1hwWVEyZE1TRGhu
      WTFSV2JHaFZORFJtZFdORlJ6TXZXbEpwVjFsNFpuaG5aR3BZV1N0MlZFTktNbWxUY1hGUEsyRlBS
      WEp2Y2s5eGRFZHNNVmx4ZVFwalVWTnNlbkI0T1U0NWJXSklMM0prWTFaSVVUTXJPREZsVG1WeWMx
      SlphSGhVWlhvck5reFRkRGt2YVM5YU4wMWxOMkpUWjB4aVVuVlhhVkJrVFRCU0NucHlRelUzTlVj
      MVpqSXhiV05UVERGak0wdExhRWRwVVdNM1pFeEtZbmh3T1hvd05rVkZUMmhXVTNNeE5VaEtTbFEw
      T0RkT1kzcFRRVFIxWlhrclQzWUtaRmQ0VkcweVFVWnhORVZyTTBWTmIxaGpRblZIZWtwTE4zRXJT
      VXBCVGtOU1VqWjVNVlZHWWpZckt6WnRheXMzYjNSRFNHcDVWMlZsYkVaaVExbFNlUXBuU1ZONFlt
      RjZiSEpLVlQwS1BUbEtZbFFLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  become: true
  tasks:
    - name: check for update
      shell: "{{ ansible_facts['pkg_mgr'] }} check-update -q {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\s*)+') }}"
      check_mode: no
      register: check_out
      failed_when: check_out.rc != 0 and check_out.rc != 100

    - when: check_out.rc == 100
      name: upgrade package
      shell: "{{ ansible_facts['pkg_mgr'] }} upgrade -v -y {{ insights_issues | regex_search('(--cve (CVE-[0-9]{4}-[0-9]+)\\s*)+') }}"

    - when: check_out.rc == 100
      name: set reboot fact
      set_fact:
        insights_needs_reboot: true

# Reboots a system if any of the preceeding plays sets the 'insights_needs_reboot' variable to true.
# The variable can be overridden to suppress this behavior.
- name: Reboot system (if applicable)
  hosts: 10.129.0.76
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRMVk0ZG5jMU9FUXJhalZ3VGtGUmFrMUVRa0ZCYTJOeE1W
      WlhVbEF3VUVoMGRIRjBWMGt4UkZSdU4zcE1kbFUyU0hKd2QxSUtUbkJ3Um5SWGJWRktiM2xxYm1w
      bE5XUmFSemMxUTNCU1kzZGFPRU5XVW5sRlRVRXpVREExZW1Kc1UzSnFWbTUxVW5oNlpVeG1SbTFy
      YW1SRVJWcHdjZ3ByWTJ0d2FFazJSVUpIYWtJemEyaGFUalJ5YTNwUWRWQm1PR1pMUVdsSE1ESmxk
      SGhXVFZWV01tZHRkV3c0UjBJMmRIcEpkRk5uVFRGQlFYQkdORTFRQ2s1NFRDOUpUMlY2ZFdRMGFt
      VlFaV05KZWpGS1dtMTVkVGgzWTNoVFZqWkpTbTVPU1VGSGVHYzVWRUpVYzNNMFEwbHVaVlZXY0RG
      VWRrUlFPUzlHVXk4S2VGaFlaMFphWlM5VlZuQjBaRzA1ZDJkbmRVOXRiR2hvWVZCTVZHNU5Tbkoy
      UVRsV2FVUnZRVzV2WWt0b1VIbEtZMHBSYjJOTFdrRlRjVTF6ZWs1VWNncHVNek5JYlRoUk9IQnRW
      VTFLYldobU9VRnZkM2x4VW5GWVVHeHpXVGwzT0UxRU1WQkZjR3htY2pJeVlYTjFMMHhvYjNGNlIz
      TmtOMUUxTTJwdFMyNXBDaXM1Y0VjeWEzVkNSVXhpVVhoblRHcERiVlZsUzFCdmJuaFhjM0JuVFZs
      M2VYQjFaVFJvYnl0dmFsZG5WRGR2ZG1GbFRFNVRTMkV2UkZOS2JEWldRaThLZEd4YUwxUXJPRFZr
      Ym5ZclNWb3phbEJTZFM5bVpuZFBkVVpVV2xoNmVGTkJUalZSV1M5ak15c3hhbUZSTDBKeFdYTmhi
      M2RpUkZreGRXUXZVeXRsYVFwa2FEa3JWRkV5TlVKa1NYa3hibGh3ZWpoV1JHbHpjbEp3Y0VrNWFs
      SldWakkwTVVVelRVWkhka1ZaTm1aVFYzSlZWMWMzY0RKbFpUbGphelpOVlUweUNrNUZjRXBLWm5G
      UFNFdHBjRXRPZVRKdVFVRTJURmcxTHpNeGFWSk9VSEZZVXpKRVdqSlpkbVZTUTJOMmVDOHZPVTlo
      UzFWd1FsZElZVmxYYW5STU4wWUtSWFJWVEZGeFZESkJPVTF3WjFSU1RtOU5WbEZ4Y1haQ01GUlBP
      WE00TmxoTmRuUkdRa1IzYW5SbWIxSm9NRnBEYlUwME1FRlhRMHBxT0RKNlduTlRZUXBCYXpkUEsy
      UkpkMFl5VVQwS1BWcEtiallLTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - when:
        - insights_needs_reboot is defined
        - insights_needs_reboot
      block:
        - name: Reboot system
          shell: sleep 2 && shutdown -r now "Ansible triggered reboot"
          async: 1
          poll: 0
          ignore_errors: true

        - name: Wait for system to boot up
          local_action:
            module: wait_for
            host: "{{ hostvars[inventory_hostname]['ansible_host'] | default(hostvars[inventory_hostname]['ansible_ssh_host'], true) | default(inventory_hostname, true) }}"
            port: "{{ hostvars[inventory_hostname]['ansible_port'] | default(hostvars[inventory_hostname]['ansible_ssh_port'], true) | default('22', true) }}"
            delay: 15
            search_regex: OpenSSH
            timeout: 300
          become: false

- name: run insights
  hosts: 10.129.0.76
  become: true
  gather_facts: false
  vars:
    insights_signature_exclude: /hosts,/vars/insights_signature
    insights_signature: !!binary |
      TFMwdExTMUNSVWRKVGlCUVIxQWdVMGxIVGtGVVZWSkZMUzB0TFMwS1ZtVnljMmx2YmpvZ1IyNTFV
      RWNnZGpFS0NtbFJTVlpCZDFWQldVaHBRaXR6ZG5jMU9FUXJhalZ3VGtGUmFXdDRaeTh2WmtaRFoz
      QXlTblIxVEd0UU5qQnNTa3BZYm1GU1JGTjVjVVYwU0ZSNlRGY0tOVlZSVlc5MWEyUmpVRFJVUlZn
      d01EaDFhRkJHUzFaSmVrdFVTR2RsYTFOaU1UUXlkMjlQYm5sR2VUUnpRbEJrZEZoaGREVlliWEp0
      VGxsR1EwaEVWZ28xYVhSdlNrcDBPVzg1UWtkQlJVaDVZMFJ3SzBoNVNqWXphM0paZVRGUk1rOXVU
      azF3VjJaSmNtYzJUakJXVTJoa1JtVk1lR0ppTjBaMlpFaEpjbFo2Q2pJNGFrdHhOemx1Tm13eUx6
      aDZZVkJSTDFkWVZIWkNaMDVhUkVWTFJ6TmhSSFl3WVRkbWIyUnlPRWhEZGxseE5tNUhNRkZOY1RO
      U1ZFOXBkbFZtTTFnS1JuQnlhVTh2TDNKSlRDOVlSelE1TTA1NGFWSjBRakVyZEhSUk0wZHNhM1ZE
      ZFVwck1EQkdaREp0ZDNZNFprRnZaR2xUUW5aelQydEpZekZyV25adFN3cEJjR3BEY1ZKMWVHaExU
      MDgzYWxZM1FYSnRTV0p6TkhobVJrUkJVMkZaV2t4R01VMHZhME42ZWs1d1MwTjFhbE5hVUUxRlVt
      WlhhV2RHVGpGMWRqRjNDalpQSzB0b1pTdFJVRU5hUm5CV1kwVndSbTFSTVdwcWFrOVFPV2haSzNW
      alZWSnhSVEkyTlhGTWRuWnFSWE4wUW5WQk4xQkZNRVZ3UkRsaU5VaFZSM1lLTkZKemJXc3pNbFpC
      Vnl0WE5IWk1VRWQwZG1sQ00wSXpUbE0wZUhCdVIzSmlObGs1Y1cwNFZuVTJSRUZIV2xOYWRsbFlk
      bWQwTm1WR2N6RTVTVFZZUWdvMGVtcFVSRUlyTW1sT2NrcE9jM2d5YURoU1VGVnJMMmhZUzFKMGEy
      WnZZMlpKZVRkcGNWY3hiMGRsTlZSMmFqTTFSbXRqUld0YU9VRnpSMjl6WXpWMENuUlZkVlZJWWpS
      ME5EVTFSSE5EWlZWc1ZEZFNOakJDTTB4d1Z6TmlTRTF0YzFCMEx6RktNRFEwYm1KS2RFTkhUM1Jy
      UVVWWVRsVTJlbGxUTDNBMFFqSUtaSFYxY2tZdlNHUnFWWFJNVDNSdlNFTnlZVWd2WkZwaFRVNTZk
      MVZpZUc1VFZXUkdZU3R6TTBaNFJHczFVVkU0VVRaMVVucFpRbWw0WkcxeWREZGpUQXBKYTA1NlEy
      aHBRMDlrY3owS1BVMVZOMk1LTFMwdExTMUZUa1FnVUVkUUlGTkpSMDVCVkZWU1JTMHRMUzB0Q2c9
      PQ==
  tasks:
    - name: run insights
      command: insights-client
      changed_when: false
